#! /bin/octave

a_is_cli_first = 1;
a = [
  [ 1115.5625, 1193.9375 ],
  [ 1240.4375, 1288.9375 ],
  [ 1322.625, 1340.5 ],
  [ 1350, 1566.4375 ],
  [ 1587.3125, 1618 ],
  [ 1641.3125, 1665.0625 ],
  [ 1684, 1708.9375 ],
  [ 1727, 1759.75 ],
  [ 1787.0625, 1800.125 ],
  [ 1824.0625, 1845.6875 ],
  [ 1887.25, 1907.0625 ],
  [ 1915.3125, 1929.75 ],
  [ 2050.3125, 2090.1875 ],
  [ 2107.1875, 2178.3125 ],
  [ 2219.625, 2259.75 ],
  [ 2270.25, 2291.75 ],
  [ 2431.375, 2465.3125 ],
  [ 2474.9375, 2486.8125 ],
  [ 2496.75, 2706.375 ],
  [ 2772.9375, 2784.375 ],
  [ 3295.5625, 3374.1875 ],
  [ 3388.5, 3404.9375 ],
  [ 3439.5, 3482.0625 ],
  [ 3491.6875, 3586.8125 ],
  [ 3597.75, 3656.1875 ],
  [ 3663.5625, 3698.1875 ],
  [ 3727, 3797.25 ],
  [ 3805.0625, 3831.625 ],
  [ 3835.5625, 3938.125 ],
  [ 3942.25, 4042.75 ],
  [ 4067.5625, 4154.5 ],
  [ 4167.5, 4215 ],
  [ 4227.0625, 4296.375 ],
  [ 4373.75, 4411.375 ],
  [ 4422.25, 4480.125 ],
  [ 4485.1875, 4498.0625 ],
  [ 4507, 4579.25 ],
  [ 4589.125, 4646.4375 ],
  [ 4651.1875, 4655.6875 ],
  [ 4664.625, 4675.5625 ],
];

b_is_cli_first = 1;
b = [
  [ 24.83, 50.61 ],
  [ 91.76, 193.67 ],
  [ 210.08, 244.37 ],
  [ 258.88, 338.75 ],
  [ 348.67, 377.09 ],
  [ 455.14, 497.14 ],
  [ 535.125, 554.0625 ],
  [ 589.5625, 643.375 ],
  [ 701.4375, 732.75 ],
  [ 825.5, 928.625 ],
  [ 955.0625, 997.375 ],
  [ 1049.4375, 1053.375 ],
  [ 1191.4375, 1297.125 ],
  [ 1323.5625, 1379.9375 ],
  [ 1408.375, 1469.375 ],
  [ 1499.0625, 1609.0625 ],
  [ 1629.25, 1721.625 ],
  [ 1740.0625, 1872.75 ],
  [ 1890.8125, 1794.4375 ],
  [ 1923.5, 1973.25 ],
  [ 2083.25, 2134.375 ],
  [ 2348.75, 2367.75 ],
  [ 2398.5, 2454.8125 ],
  [ 2466.6875, 2506.9375 ],
  [ 2540.875, 2607.125 ],
  [ 2619.4375, 2658.9375 ],
  [ 2688.5, 2719.375 ],
  [ 2734.375, 2748.1875 ],
  [ 2756.5625, 2808.125 ],
  [ 2814.9375, 2837.9375 ],
  [ 2853.5, 2896 ],
  [ 2906.4375, 2991.5625 ],
  [ 3026.6875, 3227.375 ],
  [ 3249.5, 3293.6875 ],
  [ 3309.1875, 3322 ],
  [ 3342.0625, 3368.75 ],
  [ 3387.3125, 3442.375 ],
  [ 3457.25, 3497.3125 ],
  [ 3503.375, 3507.375 ],
  [ 3508.3125, 3544.4375 ],
];

c_is_cli_first = 1;
c = [
  [ 205.625, 266.5 ],
  [ 286.9375, 405.25 ],
  [ 428.6875, 454.6875 ],
  [ 463.75, 589.625 ],
  [ 607.375, 637 ],
  [ 644, 667.625 ],
  [ 684.3125, 702.25 ],
  [ 713, 808.375 ],
  [ 818.1875, 859.125 ],
  [ 872.8125, 888.25 ],
  [ 926.625, 967.375 ],
  [ 971.0625, 988.5 ],
  [ 999.3125, 1109.1875 ],
  [ 1130, 1219.1875 ],
  [ 1235.4375, 1269.0625 ],
  [ 1275.875, 1359.5625 ],
  [ 1389.1875, 1509.25 ],
  [ 1545, 1584.875 ],
  [ 1609.25, 1615 ],
  [ 1616.875, 1624.25 ],
  [ 1949.6875, 2049.5 ],
  [ 2066.9375, 2085.5625 ],
  [ 2096.0625, 2130.75 ],
  [ 2137.5625, 2163 ],
  [ 2202.625, 2216.5 ],
  [ 2225.75, 2274.75 ],
  [ 2282.625, 2318.875 ],
  [ 2334.0625, 2348.9375 ],
  [ 2356.75, 2402.4375 ],
  [ 2409.9375, 2444.375 ],
  [ 2452.625, 2618.75 ],
  [ 2637.25, 2696.5 ],
  [ 2716.75, 2798.4375 ],
  [ 2813.25, 2853.8125 ],
  [ 2858.4375, 2889.25 ],
  [ 2894.6875, 2911.0625 ],
  [ 2917.1875, 2945.5625 ],
  [ 2958.9375, 2993.375 ],
  [ 2998.1875, 3029.375 ],
  [ 3035.0625, 3042.1875 ],
];

d_is_cli_first = 0;
d = [
  [ 443.4375, 510.5 ],
  [ 525.75, 549.9375 ],
  [ 718.0625, 826.625 ],
  [ 835.4375, 898.3125 ],
  [ 904.25, 931.6875 ],
  [ 941.9375, 974.75 ],
  [ 986.5625, 1041.125 ],
  [ 1046.75, 1077 ],
  [ 1084.125, 1111 ],
  [ 1113.3125, 1213.8125 ],
  [ 1254.75, 1306.3125 ],
  [ 1320.5, 1375.9375 ],
  [ 1480.3125, 1611.5625 ],
  [ 1621.875, 1709.5625 ],
  [ 1718.3125, 1786.375 ],
  [ 1789.3125, 1805.5625 ],
  [ 1833, 1847.8125 ],
  [ 1856, 1865.9375 ],
  [ 1873.625, 1880.0625 ],
  [ 1883.5, 1897.8125 ],
  [ 2339.6875, 2372.5625 ],
  [ 2381.8125, 2491.75 ],
  [ 2499.4375, 2533.1875 ],
  [ 2542.6875, 2573.8125 ],
  [ 2602.1875, 2663.8125 ],
  [ 2673.5625, 2710.0625 ],
  [ 2720.0625, 2821.5625 ],
  [ 2831.5625, 2856.75 ],
  [ 2873.125, 2924.375 ],
  [ 2941.0625, 2961 ],
  [ 2970.375, 3004.8125 ],
  [ 3016.375, 3022 ],
  [ 3044.125, 3076.5625 ],
  [ 3085.0625, 3178.1875 ],
  [ 3185.0625, 3236.25 ],
  [ 3242.65625, 3319 ],
  [ 3392.25, 3425.1875 ],
  [ 3431.59375, 3450.4375 ],
  [ 3456.625, 3545.5625 ],
  [ 3548.90625, 3563.84375 ],
];

e_is_cli_first = 0;
e = [
  [ 242.4375, 343.25 ],
  [ 404.8125, 444.125 ],
  [ 468.125, 538.75 ],
  [ 551.875, 835 ],
  [ 848.6875, 926.3125 ],
  [ 944.9375, 993.8125 ],
  [ 1001.75, 1080 ],
  [ 1086.75, 1107.3125 ],
  [ 1114.125, 1149.1875 ],
  [ 1155.3125, 1183.3125 ],
  [ 1188.1875, 1282.375 ],
  [ 1291.4375, 1430.1875 ],
  [ 1439.9375, 1549.9375 ],
  [ 1562.0625, 1658.25 ],
  [ 1693.875, 1734.4375 ],
  [ 1743.5625, 1771.75 ],
  [ 1787.875, 1842.625 ],
  [ 1848.4375, 1879.125 ],
  [ 1889.8125, 1895.125 ],
  [ 1904.375, 1930.875 ],
  [ 2741.125, 2807.9375 ],
  [ 2820.625, 2885.75 ],
  [ 2894.25, 2961.6875 ],
  [ 2974.25, 3060.3125 ],
  [ 3079.875, 3098.0625 ],
  [ 3117.5, 3270.5 ],
  [ 3283.25, 3312.5 ],
  [ 3339.3125, 3441.1875 ],
  [ 3457.1875, 3499.875 ],
  [ 3512.8125, 3537.3125 ],
  [ 3721.625, 3746.5 ],
  [ 3751.75, 3775.125 ],
  [ 3790.625, 3839.4375 ],
  [ 3861.25, 3929 ],
  [ 3975.375, 4009.875 ],
  [ 4015, 4074.1875 ],
  [ 4089.75, 4137.125 ],
  [ 4144.625, 4168.0625 ],
  [ 4177.5, 4194.4375 ],
  [ 4211.1875, 4228.875 ],
];

f_is_cli_first = 0;
f = [
  [ 422.5, 480.3125 ],
  [ 492.25, 515.9375 ],
  [ 568.5625, 583.25 ],
  [ 587.4375, 633.5625 ],
  [ 644.0625, 663 ],
  [ 668, 692.25 ],
  [ 705.0625, 774.5 ],
  [ 786.375, 806.5625 ],
  [ 813.9375, 831 ],
  [ 836.25, 856.625 ],
  [ 862.1875, 906.8125 ],
  [ 912.6875, 995 ],
  [ 1005.1875, 1100.875 ],
  [ 1107.8125, 1150.5625 ],
  [ 1156.5, 1180.6875 ],
  [ 1190.0625, 1215.1875 ],
  [ 1231.5625, 1272.375 ],
  [ 1282.8125, 1298.1875 ],
  [ 1302, 1308.5 ],
  [ 1312.0625, 1329.375 ],
  [ 1999.3125, 2023.3125 ],
  [ 2115.625, 2135.5 ],
  [ 2250.4375, 2265.375 ],
  [ 2294.25, 2329.125 ],
  [ 2347.25, 2356.3125 ],
  [ 2401.25, 2431.6875 ],
  [ 2446.875, 2462.0625 ],
  [ 2492.375, 2527.4375 ],
  [ 2533.5625, 2546.9375 ],
  [ 2551.6875, 2569.125 ],
  [ 2584.25, 2607.3125 ],
  [ 2611.875, 2624.625 ],
  [ 2638.3125, 2703.75 ],
  [ 2732.9375, 2774.125 ],
  [ 2836.4375, 2885.1875 ],
  [ 2887.125, 2904.625 ],
  [ 2913.5, 2962.53125 ],
  [ 2982.96875, 2995.90625 ],
  [ 3036.3125, 3077.125 ],
  [ 3077.71875, 3085.09375 ],
];

# cli = data{1};
# gui = data{2};
function res = putCliFirst(arr, is_cli_first)
  if ( length(arr) != 40 )
    "error: len != 40"
  endif

  starts = arr(:,1);
  ends = arr(:,2);
  diffs = ends - starts;

  if ( is_cli_first == 1 )
    res = {
      diffs(1:20),
      diffs(21:40)
    };
  else
    res = {
      diffs(21:40),
      diffs(1:20)
    };
  endif
endfunction
function res = cli(data)
  res = data{1};
endfunction
function res = gui(data)
  res = data{2};
endfunction

a = putCliFirst(a, a_is_cli_first);
b = putCliFirst(b, b_is_cli_first);
c = putCliFirst(c, c_is_cli_first);
d = putCliFirst(d, d_is_cli_first);
e = putCliFirst(e, e_is_cli_first);
f = putCliFirst(f, f_is_cli_first);
avgCli = (cli(a) + cli(b) + cli(c) + cli(d) + cli(e) + cli(f))/6;
avgGui = (gui(a) + gui(b) + gui(c) + gui(d) + gui(e) + gui(f))/6;

function p = combinedPerformance(data)
  p = bar(data, "grouped", "edgecolor", "white");
  set (p(1), "facecolor", "#094F9F");
  set (p(2), "facecolor", "#FD7F00");
  axis([ 0 21 ]);
  legend({"CLI", "GUI"});
  set(gca, 'xtick', 1:1:20);
  ylabel("Zeit in s");
  xlabel("Aufgaben");
  title("Performance");
  set(gca, "fontsize", 14);
endfunction

averageTaskTimes = [
  avgCli, avgGui;
];
figure(1);
p = combinedPerformance(averageTaskTimes);

function p = cliPerformance(data)
  p = bar(data, "grouped", "edgecolor", "white", "facecolor", "#094F9F", "barwidth", .27);
  axis([ 0 21 ]);
  legend({"CLI"});
  set(gca, 'xtick', 1:1:20);
  ylabel("Zeit in s");
  xlabel("Aufgaben");
  title("Cli Performance");
  set(gca, "fontsize", 14);
endfunction

figure(2);
p = cliPerformance(avgCli);

function b = percentDiffBar(x)
  hold on
  for i = 1 : length(x)
    if (x(i) < 0)
      b = bar( i, x(i), 'facecolor', "#094F9F", "barwidth", .42, "edgecolor", "white" );
    else
      b = bar( i, x(i), 'facecolor', "#FD7F00", "barwidth", .42, "edgecolor", "white" );
    endif
  endfor
  hold off;

  axis([ 0 21 ]);
  legend( "CLI schneller", "GUI schneller" );
  ylabel("Schneller erledigt in %");
  xlabel("Aufgaben");
  title("Performance Unterschiede");
  set(gca, "fontsize", 14);
  set(gca, 'xtick', 1:1:20);
  set(gca, 'ytick', -500:50:350);
endfunction

function diff = diff(data)
  diff = cli(data) - gui(data);
endfunction
avgTimeDifferences = \
  (diff(a) + diff(b) + diff(c) + diff(d) + diff(e) + diff(f))/6;
meanAvgTimeDifference = \
  sprintf("%.2f", sum(avgTimeDifferences)/length(avgTimeDifferences))

minimums = min(avgCli, avgGui);
differences = avgCli - avgGui;
percentDifference = differences.*100./minimums;

figure(3);
p = percentDiffBar(percentDifference);

waitfor(p);
